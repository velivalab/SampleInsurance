name: CI
on:
    push:
      branches: [master]
    pull_request:
      branches: [master]
jobs:
    build:
      runs-on: ubuntu-latest
      steps:
        - name: Checkout repository
          uses: actions/checkout@v2
        - name: Cache files
          uses: actions/cache@v2
          with:
              path: |
                  ~/.sonar
              key: ${{ runner.os }}-sonar
              restore-keys: ${{ runner.os }}-sonar
        - name: Run Codescan On Push
          if: github.event_name == 'push'
          uses: codescan-io/codescan-scanner-action@1.2
          with:
            organization: ‘harsh-pmb’
            projectKey: ‘autoclaim’       
            login: '48b5818f252d413b7c8dbbbb7e1c2f39eca251e0'
        - name: Run Codescan On PR
          if: github.event_name == 'pull_request'
          uses: codescan-io/codescan-scanner-action@1.2
          with:
            organization: ‘harsh-pmb’
            projectKey: ‘autoclaim’
            login: '48b5818f252d413b7c8dbbbb7e1c2f39eca251e0'
            args: |
              sonar.branch.name='master'
              sonar.branch.target='master'
              sonar.branch.type=SHORT
        - name: Upload SARIF file
          uses: github/codeql-action/upload-sarif@v1
          with:
            sarif_file: codescan.sarif
